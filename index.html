<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Goncebat Automation - Power-Up</title>
  <!-- Carga la librería de Trello Power-Up -->
  <script src="https://p.trellocdn.com/power-up.min.js"></script>
</head>
<body>
  <script>
    // URL del ícono que quieras mostrar en tu botón/sección
    var ICON_URL = 'https://nuuxia.github.io/goncebat-trello-power-up/goncebat-creative-group-icon.webp';

    // Inicializamos el Power-Up con las funciones que nos interesan
    window.TrelloPowerUp.initialize({
      // ---------- Botón en la tarjeta ----------
      'card-buttons': async function(t, opts) {
        // Solo mostramos el botón si el usuario puede editar el tablero
        let canEditBoard = await t.memberCanWriteToModel('board');
        if (!canEditBoard) {
          return []; // Si NO puede, no devolvemos nada
        }
        return [
          {
            icon: ICON_URL,
            text: 'Ingresar Datos',
            callback: function(t) {
              return t.popup({
                title: "Ingresar Datos",
                url: t.signUrl('popup.html'), // apunta a tu formulario
              });
            },
          },
        ];
      },

      // ---------- Sección en el reverso de la tarjeta ----------
      'card-back-section': async function(t, opts) {
        // Solo mostramos la sección si el usuario puede editar el tablero
        let canEditBoard = await t.memberCanWriteToModel('board');
        if (!canEditBoard) {
          return null; // Si NO puede, no devolvemos la sección
        }
        return {
          title: 'Datos de la Tarjeta',
          icon: ICON_URL,
          content: {
            type: 'iframe',
            url: t.signUrl('datos.html'), // página para mostrar los datos guardados
            height: 250 // altura del iframe (puedes ajustarla)
          }
        };
      }
    });

    console.log("✅ Power-Up Goncebat Automation cargado correctamente.");
  </script>
</body>
</html>
