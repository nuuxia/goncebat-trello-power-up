<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Goncebat Automation</title>
    <script src="https://p.trellocdn.com/power-up.min.js"></script>
</head>
<body>
    <script>
        var ICON_URL = 'https://nuuxia.github.io/goncebat-trello-power-up/goncebat-creative-group-icon.webp'; 

        window.TrelloPowerUp.initialize({
            // âœ… Agregamos solo las funciones compatibles con Trello
            'card-buttons': function (t, opts) {
                return [{
                    icon: ICON_URL,
                    text: 'Ingresar Datos',
                    callback: function (t) {
                        return t.popup({
                            title: "Ingresar Datos",
                            url: t.signUrl('popup.html')
                        });
                    }
                }];
            },

            // âœ… Solo mostramos la secciÃ³n en la tarjeta si el usuario es administrador
            'card-back-section': function (t, opts) {
                return t.get('member', 'private', 'isAdmin', false)
                    .then(function (isAdmin) {
                        if (isAdmin) {
                            return {
                                title: 'Datos de la Tarjeta',
                                icon: ICON_URL,
                                content: {
                                    type: 'iframe',
                                    url: t.signUrl('datos.html')
                                }
                            };
                        }
                        return null; // ðŸ”¥ IMPORTANTE: Evita errores devolviendo null
                    });
            },

            // âœ… Eliminamos cualquier referencia a 'card-detail-badges'
        });

        console.log("âœ… Power-Up Goncebat Automation cargado correctamente.");
    </script>
</body>
</html>
