<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Ingresar Datos</title>
  <script src="https://p.trellocdn.com/power-up.min.js"></script>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <h2>Ingresar Datos</h2>
    <form id="dataForm">
      <label>Fecha: <input type="date" id="fecha" /></label>
      <label>Origen: <input type="text" id="origen" /></label>
      <label>Cliente: <input type="text" id="cliente" /></label>
      <label>Cuenta: <input type="text" id="cuenta" /></label>
      <label>Palabras: <input type="number" id="palabras" /></label>
      <label>Ingreso: <input type="number" id="ingreso" /></label>
      <label>Egreso: <input type="number" id="egreso" /></label>
      <label>Cliente Pagó: <input type="number" id="clientePago" /></label>
      <label>Observación: <textarea id="observacion"></textarea></label>
      <button type="submit">Guardar</button>
    </form>
  </div>

  <script>
    var t = window.TrelloPowerUp.iframe();

    // Reemplaza esta URL con la de tu script de Google Sheets si lo necesitas
    const GOOGLE_SHEETS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxeE33CB1UP6JDLvbEEtBT7uXL84d13BJPdqPt4TQJvP35IYIPusTfErYpLp7ILqgm8eA/exec";

    document.getElementById("dataForm").addEventListener("submit", function(event) {
      event.preventDefault();

      var data = {
        fecha: document.getElementById("fecha").value,
        origen: document.getElementById("origen").value,
        cliente: document.getElementById("cliente").value,
        cuenta: document.getElementById("cuenta").value,
        palabras: document.getElementById("palabras").value,
        ingreso: document.getElementById("ingreso").value,
        egreso: document.getElementById("egreso").value,
        clientePago: document.getElementById("clientePago").value,
        observacion: document.getElementById("observacion").value
      };

      // Guardar en Trello con scope SHARED para que otros admins puedan ver
      t.set('card', 'shared', 'datos', data)
        .then(() => {
          // (Opcional) Enviar a Google Sheets
          fetch(GOOGLE_SHEETS_SCRIPT_URL, {
            method: "POST",
            mode: "no-cors",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
          });

          // Cerrar el popup
          t.closePopup();
        });
    });
  </script>
</body>
</html>
